<!--记账表单页-->
<view class="page-container">
  <!-- 类型切换 -->
  <view class="type-tabs">
    <view class="tab {{type === 'expense' ? 'active expense' : ''}}" bindtap="switchType" data-type="expense">
      <text>支出</text>
    </view>
    <view class="tab {{type === 'income' ? 'active income' : ''}}" bindtap="switchType" data-type="income">
      <text>收入</text>
    </view>
  </view>
  
  <!-- 金额输入 -->
  <view class="amount-section {{type}}">
    <text class="currency-symbol">¥</text>
    <input 
      class="amount-input" 
      type="digit" 
      placeholder="0.00" 
      value="{{amount}}"
      bindinput="onAmountInput"
      focus="{{amountFocus}}"
      adjust-position="{{false}}"
    />
  </view>
  
  <!-- 分类选择 -->
  <view class="section">
    <text class="section-title">选择分类</text>
    <view class="category-grid">
      <view 
        class="category-item {{selectedCategory === item.id ? 'selected ' + type + '-selected' : ''}}"
        wx:for="{{categories}}"
        wx:key="id"
        bindtap="selectCategory"
        data-id="{{item.id}}"
      >
        <view class="category-icon" style="background-color: {{selectedCategory === item.id ? 'rgba(255,255,255,0.25)' : item.color + '20'}};">
          <image src="/assets/icons/category/{{item.icon}}.png" mode="aspectFit" style="{{selectedCategory === item.id ? 'filter: brightness(0) invert(1);' : ''}}"></image>
        </view>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </view>
  
  <!-- 日期选择 -->
  <view class="section">
    <text class="section-title">日期</text>
    <picker mode="date" value="{{date}}" bindchange="onDateChange">
      <view class="date-picker">
        <image src="/assets/icons/calendar.png" mode="aspectFit"></image>
        <text>{{dateDisplay}}</text>
        <image class="arrow" src="/assets/icons/chevron-right.png" mode="aspectFit"></image>
      </view>
    </picker>
  </view>
  
  <!-- 备注 -->
  <view class="section">
    <text class="section-title">备注</text>
    <input 
      class="note-input" 
      placeholder="添加备注（可选）" 
      value="{{note}}"
      bindinput="onNoteInput"
      maxlength="100"
      type="text"
    />
  </view>
  
  <!-- 底部按钮 -->
  <view class="bottom-actions">
    <button class="btn-save {{type}}" bindtap="saveRecord" disabled="{{!canSave}}">
      {{isEdit ? '保存修改' : '保存'}}
    </button>
    <button class="btn-delete" wx:if="{{isEdit}}" bindtap="deleteRecord">
      删除记录
    </button>
  </view>
</view>

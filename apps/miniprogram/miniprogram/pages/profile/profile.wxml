<!--ä¸ªäººä¸­å¿ƒé¡µ-->
<view class="page-container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="avatar">
      <image wx:if="{{userProfile.avatar}}" class="avatar-image" src="{{userProfile.avatar}}" mode="aspectFill"></image>
      <text wx:else>{{avatarText}}</text>
    </view>
    <view class="user-info">
      <text class="nickname">{{userProfile.nickname || 'ç”¨æˆ·'}}</text>
      <text class="user-id" wx:if="{{userIdDisplay}}">ID: {{userIdDisplay}}</text>
    </view>
  </view>
  
  <!-- è´¦æœ¬ç®¡ç† -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æˆ‘çš„è´¦æœ¬</text>
      <view class="add-btn" bindtap="showCreateLedger">
        <image src="/assets/icons/plus.png" mode="aspectFit"></image>
        <text>æ–°å»º</text>
      </view>
    </view>
    
    <view class="ledger-list">
      <view 
        class="ledger-item {{item.id === currentLedger.id ? 'active' : ''}}"
        wx:for="{{ledgers}}"
        wx:key="id"
        bindtap="switchLedger"
        data-id="{{item.id}}"
      >
        <view class="ledger-icon">
          <text>{{item.icon || 'ğŸ“’'}}</text>
        </view>
        <view class="ledger-info">
          <text class="ledger-name">{{item.name}}</text>
          <text class="ledger-count">{{item.recordCount}}æ¡è®°å½•</text>
        </view>
        <view class="ledger-actions">
          <image 
            wx:if="{{item.id === currentLedger.id}}"
            class="check-icon"
            src="/assets/icons/check.png" 
            mode="aspectFit"
          ></image>
          <image 
            wx:if="{{ledgers.length > 1}}"
            class="delete-icon"
            src="/assets/icons/trash.png" 
            mode="aspectFit"
            catchtap="deleteLedger"
            data-id="{{item.id}}"
            data-name="{{item.name}}"
          ></image>
        </view>
      </view>
    </view>
  </view>
  
  <!-- æ•°æ®ç®¡ç† -->
  <view class="section">
    <text class="section-title">æ•°æ®ç®¡ç†</text>
    
    <view class="menu-list">
      <view class="menu-item" bindtap="exportData">
        <view class="menu-icon default">
          <image src="/assets/icons/download.png" mode="aspectFit"></image>
        </view>
        <text class="menu-text">å¯¼å‡ºæ•°æ®</text>
        <image class="menu-arrow" src="/assets/icons/chevron-right.png" mode="aspectFit"></image>
      </view>
      
      <view class="menu-item danger" bindtap="clearCurrentLedgerData">
        <view class="menu-icon danger">
          <image src="/assets/icons/trash.png" mode="aspectFit"></image>
        </view>
        <text class="menu-text">æ¸…é™¤å½“å‰è´¦æœ¬æ•°æ®</text>
        <image class="menu-arrow" src="/assets/icons/chevron-right.png" mode="aspectFit"></image>
      </view>
    </view>
  </view>
  
  <!-- å…³äº -->
  <view class="section">
    <text class="section-title">å…³äº</text>
    
    <view class="menu-list">
      <view class="menu-item">
        <view class="menu-icon default">
          <image src="/assets/icons/info.png" mode="aspectFit"></image>
        </view>
        <text class="menu-text">ç‰ˆæœ¬</text>
        <text class="menu-value">1.0.0</text>
      </view>
    </view>
  </view>
  
  <!-- æ–°å»ºè´¦æœ¬å¼¹çª— -->
  <view class="modal-mask" wx:if="{{showCreateModal}}" bindtap="hideCreateLedger"></view>
  <view class="modal-content" wx:if="{{showCreateModal}}">
    <text class="modal-title">æ–°å»ºè´¦æœ¬</text>
    <view class="modal-body">
      <view class="form-item">
        <text class="form-label">è´¦æœ¬åç§°</text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥è´¦æœ¬åç§°" 
          value="{{newLedgerName}}"
          bindinput="onLedgerNameInput"
          maxlength="20"
        />
      </view>
      <view class="form-item">
        <text class="form-label">é€‰æ‹©å›¾æ ‡</text>
        <view class="icon-grid">
          <view 
            class="icon-item {{newLedgerIcon === item ? 'selected' : ''}}"
            wx:for="{{ledgerIcons}}"
            wx:key="*this"
            bindtap="selectLedgerIcon"
            data-icon="{{item}}"
          >
            <text>{{item}}</text>
          </view>
        </view>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-btn cancel" bindtap="hideCreateLedger">å–æ¶ˆ</button>
      <button class="modal-btn confirm" bindtap="createLedger" disabled="{{!newLedgerName}}">åˆ›å»º</button>
    </view>
  </view>

</view>
